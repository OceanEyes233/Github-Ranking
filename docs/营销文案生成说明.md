# 营销文案自动生成功能说明

本脚本支持使用 AI 自动为每个 GitHub 热门仓库生成营销推广文案。

## 📋 生成的内容

对每个 GitHub 仓库，会自动生成：

1. **一句话简介** - 20字以内，突出核心价值
2. **使用价值** - 50-80字，说明能解决什么问题、带来什么好处
3. **用户群体** - 30字以内，明确目标用户
4. **标签分类** - 便于分类管理（如：开发工具,AI,前端）
5. **小红书推广文案** - 100-150字，轻松活泼，包含 emoji
6. **公众号推广文案** - 150-200字，专业正式，突出技术价值

## 🎯 Notion 数据库字段对应

请确保你的 Notion 数据库包含以下字段（字段名必须完全匹配）：

| 字段名 | 类型 | 说明 |
|--------|------|------|
| 名称 | Title | 仓库名称 |
| 一句话简介 | Text | AI 生成的简短介绍 |
| 使用价值 | Text | AI 生成的价值说明 |
| 用户群体 | Text | AI 生成的目标用户 |
| Github链接 | URL | 仓库链接 |
| 标签分类 | Select | AI 生成的标签（单选） |
| 小红书推广文案 | Text | AI 生成的小红书文案 |
| 公众号推广文案 | Text | AI 生成的公众号文案 |
| 日期 | Date | 添加日期 |

### ⚠️ 重要说明：标签分类字段

代码默认将"标签分类"设置为 **Select（单选）** 类型。

如果你的 Notion 数据库中"标签分类"是 **Multi-select（多选）** 类型，请修改 `src/notionService.js`：

```javascript
// 找到第 95-108 行，将这部分：
if (repo.tags) {
  // 如果你的数据库字段是 Select (单选)
  properties['标签分类'] = {
    select: {
      name: repo.tags.split(',')[0].trim() // 取第一个标签
    }
  };
  
  // 如果你的数据库字段是 Multi-select (多选)，使用下面这个：
  // properties['标签分类'] = {
  //   multi_select: repo.tags.split(',').map(tag => ({ name: tag.trim() }))
  // };
}

// 改为：
if (repo.tags) {
  properties['标签分类'] = {
    multi_select: repo.tags.split(',').map(tag => ({ name: tag.trim() }))
  };
}
```

## ⚙️ 配置 OpenAI API

### 方法 1: 使用 OpenAI 官方 API（推荐）

1. **获取 API Key**
   - 访问 https://platform.openai.com/api-keys
   - 登录或注册账号
   - 点击 "Create new secret key"
   - 复制 API Key

2. **配置环境变量**
   
   在 `.env` 文件中添加：
   ```
   OPENAI_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxx
   ```

3. **选择模型（可选）**
   
   默认使用 `gpt-3.5-turbo`，你也可以选择其他模型：
   ```
   OPENAI_MODEL=gpt-4
   ```
   
   可用模型：
   - `gpt-3.5-turbo` - 便宜快速（推荐）
   - `gpt-4` - 更智能，但更贵
   - `gpt-4-turbo-preview` - 最新最强

### 方法 2: 使用国内代理服务

如果无法访问 OpenAI 官方 API，可以使用国内代理服务：

```env
OPENAI_API_KEY=你的API Key
OPENAI_API_BASE=https://api.openai-proxy.com/v1
```

常见的代理服务：
- https://api.openai-proxy.com/v1
- https://api.chatanywhere.com.cn/v1
- 其他兼容 OpenAI API 的服务

### 方法 3: 不使用 AI（使用默认文案）

如果不配置 `OPENAI_API_KEY`，脚本会自动使用默认的文案生成逻辑：

- 一句话简介：使用 GitHub 仓库的 description
- 使用价值：基于仓库信息自动拼接
- 用户群体：根据编程语言推断
- 标签分类：使用编程语言
- 小红书文案：使用预设模板
- 公众号文案：使用预设模板

**优点**：免费，无需配置
**缺点**：文案质量较低，不够个性化

## 💰 费用说明

### OpenAI API 费用（方法 1）

- **gpt-3.5-turbo**: 约 $0.002 / 请求
- **gpt-4**: 约 $0.06 / 请求

**示例**：每天处理 10 个仓库
- 使用 gpt-3.5-turbo: 约 $0.02/天 = $0.6/月
- 使用 gpt-4: 约 $0.6/天 = $18/月

新用户通常有 $5 的免费额度，可以用很久。

### 国内代理费用（方法 2）

根据不同服务商，通常比官方便宜 20-50%。

### 默认文案（方法 3）

完全免费！

## 🚀 使用流程

### 完整配置（推荐）

```bash
# 1. 安装依赖
npm install

# 2. 配置环境变量
# 编辑 .env 文件，添加：
GITHUB_TOKEN=你的GitHub Token
NOTION_API_KEY=你的Notion API Key
NOTION_DATABASE_ID=你的数据库ID
OPENAI_API_KEY=你的OpenAI API Key

# 3. 运行
npm start
```

### 最小配置（仅使用默认文案）

```bash
# 1. 安装依赖
npm install

# 2. 配置 Notion（必需）
# 编辑 .env 文件，添加：
NOTION_API_KEY=你的Notion API Key
NOTION_DATABASE_ID=你的数据库ID

# 3. 运行（不配置 OPENAI_API_KEY）
npm start
```

## 📊 运行效果示例

### 使用 AI 生成

```
开始获取 GitHub 热门仓库...
✓ 成功获取 10 个热门仓库

开始为 10 个仓库生成营销内容...

[1/10] 正在处理: facebook/react
  ✓ 生成完成

[2/10] 正在处理: microsoft/vscode
  ✓ 生成完成

...

营销内容生成完成!

正在保存到 Notion 数据库...

✓ 已添加到 Notion: facebook/react
✓ 已添加到 Notion: microsoft/vscode
...

✓ 已成功保存到 Notion 数据库
```

### 使用默认文案

```
开始获取 GitHub 热门仓库...
✓ 成功获取 10 个热门仓库

开始为 10 个仓库生成营销内容...

未配置 OPENAI_API_KEY，使用默认内容

[1/10] 正在处理: facebook/react
  ✓ 生成完成

...
```

## 🔧 自定义 AI 提示词

如果想修改 AI 生成的风格，可以编辑 `src/aiService.js` 中的 prompt：

```javascript
const prompt = `你是一个专业的技术产品营销专家。请基于以下 GitHub 仓库信息，生成营销内容：

仓库名称：${repo.name}
描述：${repo.description}
...

请生成以下内容...
`;
```

你可以调整：
- 角色定位（如：更年轻化、更专业、更幽默）
- 文案长度
- 文案风格
- 目标受众

## ❓ 常见问题

### Q1: AI 生成失败怎么办？

**答**：脚本会自动降级使用默认文案，不会中断运行。

### Q2: 可以使用其他 AI 服务吗？

**答**：可以！只要服务兼容 OpenAI API 格式，修改 `OPENAI_API_BASE` 即可。例如：
- Azure OpenAI
- Claude API（需要修改代码）
- 通义千问（需要修改代码）
- 文心一言（需要修改代码）

### Q3: 如何提高文案质量？

**答**：
1. 使用 gpt-4 模型（更贵但更好）
2. 修改 prompt 增加更多上下文
3. 调整 temperature 参数（在代码中）
4. 手动修改生成的文案

### Q4: 可以只生成部分字段吗？

**答**：可以！修改 `src/aiService.js` 中的代码，注释掉不需要的字段。

### Q5: Notion 保存失败，提示字段不存在？

**答**：检查 Notion 数据库中的字段名是否与代码中完全一致（区分中英文、标点符号）。

必需字段：
- 名称（Title 类型）
- 日期（Date 类型）

其他字段如果不存在，可以在 Notion 中添加，或在 `src/notionService.js` 中注释掉。

## 📝 修改默认文案模板

如果不使用 AI，但想自定义默认文案，可以修改 `src/aiService.js` 中的这些函数：

- `generateDefaultValue()` - 使用价值
- `generateDefaultAudience()` - 用户群体
- `generateDefaultXiaohongshu()` - 小红书文案
- `generateDefaultWechat()` - 公众号文案

## 🎉 总结

- ✅ 支持 AI 生成和默认文案两种模式
- ✅ 配置简单，开箱即用
- ✅ 生成失败自动降级，不影响运行
- ✅ 完全匹配你的 Notion 数据库结构
- ✅ 可自定义文案风格和长度

祝使用愉快！如有问题，请查看主 README.md 或提 Issue。


