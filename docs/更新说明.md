# 更新说明 - AI 营销文案生成功能

## 🎉 新功能概览

项目已更新，现在支持为每个 GitHub 热门仓库自动生成营销推广文案！

### 新增内容

✅ **AI 自动生成营销文案**（使用 OpenAI API）
- 一句话简介（20字以内）
- 使用价值（50-80字）
- 用户群体定位
- 标签分类
- 小红书推广文案（轻松活泼，带 emoji）
- 公众号推广文案（专业正式）

✅ **支持默认文案**（无需 OpenAI API，免费使用）

✅ **完全匹配你的 Notion 数据库结构**

## 📝 Notion 数据库字段变更

### 之前的字段结构（旧版）
- 名称
- 描述
- ⭐ Stars
- 今日新增
- 语言
- URL
- 作者
- Forks
- 日期

### 现在的字段结构（新版）
- **名称** (Title) - 必需
- **一句话简介** (Text) - 新增
- **使用价值** (Text) - 新增
- **用户群体** (Text) - 新增
- **Github链接** (URL)
- **标签分类** (Select) - 新增
- **小红书推广文案** (Text) - 新增
- **公众号推广文案** (Text) - 新增
- **日期** (Date) - 必需

## 🔧 需要的操作

### 1. 更新 Notion 数据库结构

你需要在现有的 Notion 数据库中添加新字段：

1. 打开你的 Notion 数据库
2. 点击 "+" 添加新列
3. 依次添加以下字段：
   - **一句话简介** (Text 类型)
   - **使用价值** (Text 类型)
   - **用户群体** (Text 类型)
   - **标签分类** (Select 类型)
   - **小红书推广文案** (Text 类型)
   - **公众号推广文案** (Text 类型)

**重要**：字段名称必须完全匹配（包括中文字符）！

### 2. 更新环境变量（可选）

如果想使用 AI 生成高质量文案，在 `.env` 文件中添加：

```env
# OpenAI API Key（可选）
OPENAI_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxx

# OpenAI Model（可选，默认 gpt-3.5-turbo）
OPENAI_MODEL=gpt-3.5-turbo

# OpenAI API Base（可选，默认官方地址）
OPENAI_API_BASE=https://api.openai.com/v1
```

如果不配置 OpenAI，脚本会使用默认的文案模板（完全免费）。

### 3. 重新安装依赖（如果需要）

项目没有新增依赖，但为了确保一切正常：

```bash
npm install
```

## 🚀 使用方式

### 方式 1: 使用 AI 生成（推荐）

配置 `OPENAI_API_KEY` 后直接运行：

```bash
npm start
```

效果：
- ✅ 高质量的文案
- ✅ 个性化的描述
- ✅ 适合直接用于推广

费用：约 $0.02/天（使用 gpt-3.5-turbo）

### 方式 2: 使用默认文案（免费）

不配置 `OPENAI_API_KEY`，直接运行：

```bash
npm start
```

效果：
- ✅ 完全免费
- ✅ 基于模板生成
- ⚠️ 文案质量较低，需要手动修改

## 📂 新增文件

| 文件名 | 说明 |
|--------|------|
| `src/aiService.js` | AI 文案生成服务 |
| `营销文案生成说明.md` | 详细的功能说明和配置指南 |
| `使用示例.md` | 完整的使用示例和效果展示 |
| `更新说明.md` | 本文件 |

## 🔄 修改的文件

| 文件名 | 修改内容 |
|--------|----------|
| `src/notionService.js` | 更新字段映射，匹配新的数据库结构 |
| `index.js` | 添加 AI 文案生成流程 |
| `fetch-once.js` | 添加 AI 文案生成流程 |
| `config.example.env` | 添加 OpenAI 配置项 |
| `README.md` | 更新功能说明和配置步骤 |
| `WINDOWS使用指南.md` | 添加新功能说明 |

## ⚠️ 重要提醒

### 关于"标签分类"字段类型

代码默认将"标签分类"设为 **Select（单选）** 类型。

如果你的 Notion 数据库中该字段是 **Multi-select（多选）**，需要修改代码：

打开 `src/notionService.js`，找到第 95-108 行：

```javascript
// 将这部分：
if (repo.tags) {
  properties['标签分类'] = {
    select: {
      name: repo.tags.split(',')[0].trim()
    }
  };
}

// 改为：
if (repo.tags) {
  properties['标签分类'] = {
    multi_select: repo.tags.split(',').map(tag => ({ name: tag.trim() }))
  };
}
```

## 💡 使用建议

1. **先测试默认文案**
   ```bash
   npm test
   ```
   不配置 OpenAI，先看看默认文案的效果

2. **如果满意默认文案**
   直接使用，完全免费

3. **如果需要更好的文案**
   配置 OpenAI API Key，使用 AI 生成

4. **如果预算有限**
   - 使用 gpt-3.5-turbo（便宜）
   - 或使用默认文案后手动润色

## 📖 详细文档

- **功能详解**: [营销文案生成说明.md](营销文案生成说明.md)
- **使用示例**: [使用示例.md](使用示例.md)
- **完整文档**: [README.md](README.md)
- **Windows 指南**: [WINDOWS使用指南.md](WINDOWS使用指南.md)

## 🎯 快速开始

### Windows 用户

1. 双击 `install.bat` 安装
2. 双击 `test.bat` 测试
3. 用记事本编辑 `.env` 文件，添加 Notion 配置
4. （可选）添加 OpenAI API Key
5. 双击 `start.bat` 启动

### 命令行用户

```bash
# 安装依赖
npm install

# 测试（不保存到 Notion）
npm test

# 配置 .env 文件
# 编辑 .env，添加必要的 API Keys

# 启动
npm start
```

## 🆘 遇到问题？

### Notion 保存失败

**错误信息**: `validation_error` 或 `property not found`

**解决方案**:
1. 检查 Notion 数据库字段名是否完全匹配
2. 确保 Integration 已连接到数据库
3. 查看 [营销文案生成说明.md](营销文案生成说明.md) 的疑难解答部分

### AI 生成失败

**错误信息**: `API rate limit` 或 `Unauthorized`

**解决方案**:
1. 检查 OpenAI API Key 是否正确
2. 确认账户有余额
3. 如果网络问题，配置 `OPENAI_API_BASE` 使用代理
4. 或者不配置 API Key，使用默认文案

### 字段类型不匹配

**错误信息**: 标签分类字段保存失败

**解决方案**:
查看上面"关于标签分类字段类型"部分的说明

## 🎉 更新亮点

- ✅ 无缝集成，不影响现有功能
- ✅ 支持 AI 和默认两种模式
- ✅ 详细的文档和示例
- ✅ 适配你的 Notion 数据库结构
- ✅ 中文文档，易于理解

## 📊 对比

### 更新前
```
GitHub 仓库 → 基本信息 → Notion
```

### 更新后
```
GitHub 仓库 → 基本信息 → AI 生成营销文案 → Notion
```

现在每个仓库都有完整的营销推广素材，可以直接用于：
- 📱 小红书发布
- 📝 公众号文章
- 💬 团队分享
- 📊 技术报告

---

**开始使用新功能吧！** 🚀

有任何问题，欢迎查看详细文档或提 Issue。



